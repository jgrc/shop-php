services:

  # DOCTRINE
  category.repository:
    class: Jgrc\Shop\Infrastructure\Persistence\Orm\Repository\DoctrineCategoryRepository
    arguments:
      - '@doctrine.orm.entity_manager'

  # DOMAIN SERVICES
  category.factory:
    class: Jgrc\Shop\Domain\Category\Service\CategoryFactory

  # COMMAND HANDLERS
  create.category.handler:
    class: Jgrc\Shop\Application\Category\CreateCategoryHandler
    arguments:
      - '@category.factory'
      - '@category.repository'
    tags:
      - { name: messenger.message_handler, bus: messenger.command.bus }

  # CLI COMMANDS
  cli.category.create:
    class: Jgrc\Shop\Infrastructure\Ui\Cli\Category\CreateCategoryCli
    arguments:
      - '@command.bus'
      - '@clock'
    tags:
      - console.command
